<!-- index.wxml -->
<wxs src="../../components/utils/time.wxs" module="time" />
<view class="contract-create">
  <view class="contract-block">
    <view class='contract-item'>
      <view class='item-right'>{{contract.contractTypeText}}</view>
    </view>
    <view class='contract-item'>
      <view class='item-left' wx:if="{{contract.contractType==0}}">甲方：</view>
      <view class='item-left' wx:else>授权方：</view>
      <view class='item-right'>{{contract.first}}</view>
    </view>
    <view class='contract-item'>
      <view class='item-left' wx:if="{{contract.contractType==0}}">乙方：</view>
      <view class='item-left' wx:else>被授权方：</view>
      <view class='item-right'>{{contract.second}}</view>
    </view>
    <view class='contract-item'>
      <view class='item-left' wx:if="{{contract.contractType==0}}">创建合同日期：</view>
      <view class='item-left' wx:else>创建授权日期：</view>
      <view class='item-right'>{{time.format(contract.createTime)}}</view>
    </view>
    <view class='contract-item'>
      <view class='item-left'>合同状态：</view>
      <view class='item-right'>{{contract.stateText}}</view>
    </view>
    <image class='buyerSeal' src="{{contract.firstSeal}}"  mode="widthFix" />
  </view>
  <view class="contract-block">
    <view class='contract-item'>
      <view class='item-left' wx:if="{{contract.contractType==0}}">合同有效期：</view>
      <view class='item-left' wx:else>合同有效期：</view>
      <view class='item-right'>{{contract.startTime}} 至 {{contract.endTime}}</view>
    </view>
    <view class='contract-item' wx:if="{{contractType == 0}}">
      <view class='item-left'>合同约定账期：</view>
      <view class='item-right'>{{contract.contract.month}}个月</view>
    </view>
  </view>
  <view class="contract-block" wx:if="{{contract.history.length > 0}}">
    <view class='contract-item'>
      <view class='item-left'>日期：</view>
      <view class='item-right'>{{contract.history[0].operationTime}}</view>
    </view>
    <view class='histroy-item'>
      <view class='item-left'>{{historytype[contract.history[0].type]}}</view>
      <view class='item-right'>{{contract.history[0].content}}</view>
    </view>
    <navigator class="history-list" url="../contract-history/index?cid={{contract.cid}}">查看历次明细 ></navigator>
  </view>
  <navigator class="history-list" url="../contract-detail-h5/index?url={{contract.url}}">
  <view class="contract-block">
    <view class="attr">
      <view class="attr-name">查看合同</view>
      <view class="attr-value"></view>
      <image class="sanjiao-img" src="../../assets/images/aboutme_ic_enter.png" mode="aspectFit" />
    </view>
  </view>
  </navigator>
  <view class="contract-block" wx:if="{{contract.pictures.length > 0}}">
    <view class="attr">
      <view class="title-name">单据图片</view>
      <view class='img-view'>
        <view class='img-item' wx:for="{{contract.pictures}}" data-list="{{contract.pictures}}" data-src="{{item}}" bindtap="imgYu">
          <image class="img" src="{{item}}"  mode="widthFix" />
        </view>
      </view>
    </view>
  </view>
  <view class="bottom-banner"  wx:if="{{(contract.state==1 && contract.type==1) || contract.state==0}}">
    <navigator url='../contract-create/index?cid={{contract.cid}}'>
      <button class="other-button-hover {{contract.state==1?'other-button-hover-2':''}}" wx:if="{{contract.state==1 && contract.type == 0}}" >修改合同</button>
    </navigator>
    <button  bindtap="default" wx:if="{{(contract.state==1 || contract.state==0) && contract.type == 0}}" class="other-button-hover {{contract.state==1?'other-button-hover-2 blue-btn':''}}" bindtap="cancelcontract">
      取消合同
    </button>
    <button  catchtap="confrimcontract"  wx:if="{{contract.state==0 && contract.type == 1}}" class="other-button-hover" bindtap="confrimcontract">
      确认合同
    </button>
  </view>
  <view class='bottom-view'></view>
  <dialog visible="{{jujuedialog}}" title="拒绝原因" opacity="0.5"  show-footer="true" close-on-click-modal="{{options.closeonclickmodal}}" bindclose="jujuedialogClose" bindopen="handleOpen" bindconfirm="refuse" confirmText="确认提交">
  <view class='textare1-view'>
    <textarea class='textare1' placeholder="填写拒绝理由" bindinput='getremark' />
  </view>
  </dialog>
</view>